# SSH Client for iOS

一个功能完整的iOS SSH客户端应用，支持多主机连接、持久化会话管理和SFTP文件传输。

## ✨ 主要功能

### 🖥️ SSH连接管理
- **多主机支持**：添加和管理多个SSH服务器
- **灵活认证**：支持密码和公钥两种认证方式
- **连接信息**：记录最后连接时间和连接状态

### 🔄 持久化会话
- **多会话支持**：每个主机可以创建多个独立会话
- **后台运行**：关闭会话界面，任务继续在后台执行
- **会话切换**：自由切换不同会话，任务互不干扰
- **断线重连**：自动检测连接状态并重新连接
- **会话管理**：
  - 创建新会话并命名
  - 删除会话时停止所有任务
  - 会话状态实时显示（已连接/连接中/重连中/错误）

### 💻 终端控制台
- **命令执行**：实时执行SSH命令
- **输出显示**：
  - 命令输入（蓝色）
  - 标准输出（默认）
  - 错误输出（红色）
  - 系统消息（绿色）
- **丝滑滚动**：历史记录平滑滚动，自动跟随最新输出
- **时间戳**：每条输出都有精确时间记录
- **文本选择**：支持复制终端输出

### 📁 SFTP文件管理
- **文件浏览**：浏览远程服务器文件系统
- **文件操作**：
  - 上传文件到服务器
  - 下载文件到本地
  - 删除远程文件
  - 创建新文件夹
- **详细信息**：显示文件大小、权限、修改时间、所有者
- **目录导航**：点击文件夹快速进入

## 🎨 UI设计特点

- **现代化界面**：采用SwiftUI构建，遵循iOS设计规范
- **渐变色彩**：优美的渐变配色方案
- **状态指示**：实时显示连接状态和会话活动状态
- **流畅动画**：所有交互都有平滑的动画效果
- **响应式布局**：支持iPhone和iPad，横屏竖屏自适应

## 📱 使用流程

### 1. 添加SSH主机
1. 点击右上角 `+` 按钮
2. 填写主机信息：
   - 名称：给主机起个好记的名字
   - 主机名或IP：服务器地址
   - 端口：默认22
   - 用户名：SSH登录用户名
3. 选择认证方式：
   - 密码：输入SSH密码
   - 公钥：粘贴私钥内容
4. 点击"Save"保存

### 2. 创建会话
1. 点击已添加的主机
2. 点击右上角菜单，选择"New Session"
3. 输入会话名称（如："后端部署"、"数据库管理"）
4. 系统自动连接并打开终端

### 3. 使用终端
1. 在底部输入框输入命令
2. 点击发送按钮或回车执行
3. 查看命令输出
4. 上下滑动查看历史记录

### 4. 会话切换与管理
- **切换会话**：返回会话列表，选择其他会话
- **后台运行**：切换到其他会话，原会话任务继续执行
- **重新连接**：点击菜单中的"Reconnect"
- **断开连接**：点击菜单中的"Disconnect"
- **删除会话**：点击菜单中的"Delete Session"（任务会停止）

### 5. 使用SFTP
1. 在会话列表页面，点击右上角菜单
2. 选择"SFTP Browser"
3. 浏览文件系统
4. 点击文件进行下载或删除操作
5. 使用菜单上传文件或创建文件夹

## 🔧 技术实现

### 架构设计
```
SSHClient/
├── Models/              # 数据模型
│   ├── Host.swift       # 主机信息
│   ├── SSHSession.swift # 会话和命令输出
│   └── SFTPFile.swift   # SFTP文件信息
├── Managers/            # 业务逻辑
│   ├── HostManager.swift          # 主机管理
│   ├── SessionManager.swift       # 会话管理
│   ├── SSHConnectionHandler.swift # SSH连接处理
│   └── SFTPManager.swift          # SFTP管理
├── Views/               # 界面视图
│   ├── HostListView.swift    # 主机列表
│   ├── AddHostView.swift     # 添加主机
│   ├── SessionListView.swift # 会话列表
│   ├── TerminalView.swift    # 终端控制台
│   └── SFTPBrowserView.swift # SFTP浏览器
├── SSHClientApp.swift   # 应用入口
└── ContentView.swift    # 主视图
```

### 核心技术
- **SwiftUI**：现代化的声明式UI框架
- **Combine**：响应式数据流管理
- **UserDefaults**：数据持久化存储
- **SSH协议**：远程服务器连接（当前为模拟实现）

### 会话持久化原理
1. 会话信息保存在UserDefaults
2. SSH连接在后台持续运行
3. 定时器监控连接状态
4. 断线自动重连机制
5. 会话输出历史完整保存

## 🚀 部署说明

### 环境要求
- iOS 16.0+
- Xcode 14.0+
- Swift 5.0+

### 安装步骤
1. 克隆项目
```bash
git clone <repository-url>
cd SSHClient
```

2. 打开项目
```bash
open SSHClient.xcodeproj
```

3. （可选）安装SSH库以启用真实SSH功能
```bash
pod install
open SSHClient.xcworkspace
```

### 启用真实SSH功能

当前实现使用模拟的SSH连接用于演示UI和交互流程。要启用真实的SSH功能，需要：

1. **安装SSH库**
   
   推荐使用以下库之一：
   - **NMSSH**：Objective-C实现，功能完整
   ```ruby
   # 在Podfile中取消注释
   pod 'NMSSH', '~> 2.3'
   ```
   
   - **Shout**：纯Swift实现
   ```ruby
   pod 'Shout'
   ```

2. **替换SSHConnectionHandler.swift**
   
   在`SSHConnectionHandler.swift`中替换模拟实现为真实的SSH连接代码。详见`IMPLEMENTATION_GUIDE.md`。

## 📋 功能清单

- [x] 主机管理（添加、编辑、删除）
- [x] 多会话支持
- [x] 会话持久化
- [x] 终端命令执行
- [x] 丝滑历史滚动
- [x] 断线自动重连
- [x] 会话状态指示
- [x] SFTP文件浏览
- [x] 文件上传下载
- [x] 现代化UI设计
- [ ] 真实SSH连接（需集成SSH库）
- [ ] 密钥管理器
- [ ] 命令历史记录
- [ ] 快捷命令模板
- [ ] 端口转发
- [ ] 深色模式优化

## 🔐 安全说明

- 密码和私钥存储在UserDefaults中（生产环境应使用Keychain）
- 建议使用公钥认证而非密码
- 不要在不安全的网络环境下使用
- 定期更新SSH密钥

## 📝 开发计划

### v1.1
- [ ] 集成NMSSH库，实现真实SSH连接
- [ ] 使用Keychain存储敏感信息
- [ ] 支持多点触控手势

### v1.2
- [ ] 命令自动补全
- [ ] 语法高亮
- [ ] 分屏多会话显示

### v2.0
- [ ] 支持SSH隧道和端口转发
- [ ] 支持跳板机
- [ ] 云端配置同步

## 📄 文档

- [实现指南](IMPLEMENTATION_GUIDE.md) - 详细的技术实现说明
- [项目结构](SSHClient/) - 源代码目录

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 许可证

MIT License

## 👨‍💻 作者

Created with ❤️ for iOS developers